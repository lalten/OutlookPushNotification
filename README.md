# OutlookPushNotification
Push a Notification to your phone when you receive new emails

## Idea
Your work outlook is only accessible through a proxy, in a VPN, on a virtual machine, on your work laptop. But you want your phone to tell you that there is new mail instead of manually checking in the VM every now and then. You build a tool that makes Outlook trigger a phone notification.

## Set up
### Set up Pushbullet
  1. Log in at [Pushbullet.com](https://www.pushbullet.com/)
  1. Generate a new API key with the "Create new Access Token" button on your [account settings](https://www.pushbullet.com/#settings/account). It looks something like `o.CxkYuhwynGLRhRXIeBKNGvBbPwmHCsks` <!-- don't worry, this one is randomly generated by me -->
  1. Install and set up the [Pushbullet app](https://play.google.com/store/apps/details?id=com.pushbullet.android) on your phone to be able to receive the notifications

### Find your proxy setting
The easiest way by far is to use Chrome. Open the page [`chrome://net-internals/#proxy`](chrome://net-internals/#proxy)

It has a PAC proxy config script url. If you open that, it downloads the PAC file. Open that and find your proxy settings (`PROXY proxyname.yourcorporation.com:port`)

### Set up python requirements
On the machine that runs your Outlook,
  1. If you haven't, [install Python](https://www.python.org/downloads/). You don't need to set it up system-wise if you don't have admin rights! Just choose the version that extracts to a folder.
  1. Install the Pywin32 package. It allows us to programmatically access Outlook. Since you're behind a proxy you need the `--proxy` argument.
```
  pip install pywin32 --proxy="https://username:password@proxy:port"
```
  Obviously, fill in the proxy server from the previous step and fill in your username and password.
  1. Install the Pushbullet.py package. Note that the 0.10.0 version available from Pypi does not support proxy auth. You need at least the newer 0.11.0 release from the git repo. Install from zip, or, if you have git installed, like this:
```
  pip install git+https://github.com/randomchars/pushbullet.py/releases/latest --proxy="https://username:password@proxy:port"
```

### Configure your python script
  1. Clone this repo or just download the main python file.
  2. Adjust the `api_key` and `proxy` fields to your configuration
  3. Put it anywhere where you don't just accidentally delete it ;)

### Configure Outlook
  In my Outlook 2007, The process is as follows:
  1. Tools > Rules and Alerts > New rule
    - "Check messages when they arrive"
    - No conditions (just click next)
    - start application
      - set file filter to "All files"
      - select your push_notification.py
    - No exceptions (just click next)
    - Give it a name like "Push Notification", Finish
  2. You need to make sure that Outlook executes the file with a python interpreter. To do this,
    - Locate a .py file (e.g. the push_notification.py) in the Windows file explorer or on the desktop
    - Right click it and select Properties.
    - In the first Tab, "Opens with:" needs to be a Python interpreter. If it isn't, press the "Change..." button and find (may need to "Browse...") your python.exe
    - You can now check if the script works by double-clicking it to execute it. It should send the last email as notifcation to your phone


## Contribute
If you got this working, cheers! In case you need additional steps to get this working or something was wrong or unclear, please feel free to create a pull request.
